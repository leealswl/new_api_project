game2

<section class="container mt-4" id="game-sys">
      <!-- 자바스크립동적 -->
      <div id="game-list" class="d-flex flex-wrap justify-content-start"></div>
    </section>
    <section class="container mt-4">
        <div class="row justify-content-center">
          <div class="col-lg-12 col-md-8 col-lg-6 text-center">
            <h2 class="game-zone">게임 선택</h2>
            <div id="drop-zone" class="drop-zone mt-4">
              <p class="drop-box" placeholder="asdf"></p>
            </div>
            <button id="recommend-btn" type="button" class="btn btn-primary mt-3">추천???</button>
          </div>
        </div>
    </section>

    const API_KEY1=`9487a4535e60442eb301ed9ec7f83dfa`;
let gameList=[];

const callAPI = async() => {
    try {
        let url = new URL(`https://api.rawg.io/api/games?key=${API_KEY1}&page_size=20`);
        let response = await fetch(url);
        let data = await response.json();
        gameList = data.results;
        render();
        console.log("게임 데이터:", gameList);
      } catch (error) {
        console.error("API 요청 실패:", error);
        document.getElementById('game-list').innerHTML = `<p>게임 데이터를 불러올 수 없습니다.</p>`;
      }
    };
    callAPI();

// 배열 그룹화하는 함수
const chunkArray = (array, chunkSize) => {
  const chunks = [];
  for (let i = 0; i < array.length; i += chunkSize) {
    chunks.push(array.slice(i, i + chunkSize));
  }
  return chunks;
};
const render = () => {
  const chunks = chunkArray(gameList, 5);
  const gameHTML = chunks.map(chunk => `
    <div class="game-container">
      ${chunk.map(item => `
        <div class="game-card" draggable="true">
        <a href="detail.html?id=${item.id}">
          <img src="${item.background_image}" class="img-fluid game-thumbnail">
          <p class="game-title">${item.name}</p>
        </a>
          </div>`).join("")}
    </div>`).join("");
  document.getElementById("game-list").innerHTML = gameHTML;
  
  // 각 게임 카드에 드래그 시작 이벤트 부착
  const gameCards = document.querySelectorAll('.game-card');
  gameCards.forEach(card => {
    card.addEventListener('dragstart', (event) => {
      event.dataTransfer.setData('text/html', card.outerHTML);
    });
  });
};

let hasDroppedGame = false; // 게임이 드롭되었는지 여부
let recommendedShown = false; // 추천 게임이 표시되었는지 여부

const recommendRandomGame = () => {
  if (gameList && gameList.length > 0) {
    const randomIndex = Math.floor(Math.random() * gameList.length);
    const randomGame = gameList[randomIndex];
    const randomGameHTML = `
      <div class="game-card">
        <img src="${randomGame.background_image}" class="img-fluid game-thumbnail">
        <p class="game-title">${randomGame.name}</p>
      </div>
    `;
    const dropZone = document.getElementById('drop-zone');
    // 드래그 영역의 기존 데이터를 제거 후 추천 게임만 표시
    dropZone.innerHTML = randomGameHTML;
  }
};

document.addEventListener('DOMContentLoaded', () => {
  render(); 

  const dropZone = document.getElementById('drop-zone');
  const recommendBtn = document.getElementById('recommend-btn');

  dropZone.addEventListener('dragover', (event) => {
    event.preventDefault();
    dropZone.classList.add('drop-zone-active');
  });
  dropZone.addEventListener('dragleave', () => {
    dropZone.classList.remove('drop-zone-active');
  });
  dropZone.addEventListener('drop', (event) => {
    event.preventDefault();
    dropZone.classList.remove('drop-zone-active');
    // 드래그한 게임 카드 HTML 가져오기
    const gameCardHTML = event.dataTransfer.getData('text/html');
    dropZone.innerHTML += gameCardHTML;
    hasDroppedGame = true; // 드랍되었음을 표시
  });

   // 추천 버튼 클릭 시: 게임이 드롭된 경우에만 추천 진행
   if (recommendBtn) {
    recommendBtn.addEventListener('click', () => {
      // 드래그해서 게임이 drop-zone에 없으면 아무 동작도 하지 않음
      if (!hasDroppedGame) return;
      if (!recommendedShown) {
        // 드래그 영역의 기존 데이터 제거 후 추천 게임 추가
        recommendRandomGame();
        recommendedShown = true;
        // 버튼 비활성화하여 추가 추천 방지
        recommendBtn.disabled = true;
      }
    });
  }
});

#game-sys {
    max-width: 1500px;
    margin: 0 auto;
    padding: 20px;
    text-align: center;
    background-color: black;
}
.game-thumbnail {
  width: 100%;
  height: 200px;
  object-fit: cover;
}
.game-card {
  flex: 20%;
  max-width: 50%;
  text-align: center;
  padding: 10px;
  box-sizing: border-box;
  overflow: hidden;
}
.game-card:hover {
  cursor: pointer;
}
.game-container {
  width: 100%;
  display: flex;
  justify-content: flex-start; 
  margin-bottom: 1rem;
}
.game-title {
  margin-top: 0.5rem;
  text-align: center;
}
.game-zone{
  white-space: nowrap;
}
.drop-zone {
  width: 650px;
  height: 300px;
  border: 2px dashed #ccc;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto;
}
.drop-zone-wrapper {
  display: flex;
  justify-content: center;
}
.drop-zone-active {
  background-color: #e9ecef;
}

.drop-box {
  text-align: center;
}